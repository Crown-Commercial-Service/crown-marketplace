<script type="application/javascript" language="JavaScript1.5">
  window.addEventListener('popstate', function(e){
      alert(e.state.href);
   });

  if (window.location.pathname.indexOf('facilities-management') > -1 ) {
    if (!(['gateway','sign-in','start'].some(function(word) {
        return window.location.pathname.indexOf(word) > 0;
      }))) {
      let body = $(document.body);
      if (body.attr('validation_id') !== '') {
      alert('h');
        $.ajax({
                  method: 'get',
                  url:'/facilities-management/gateway/validate/' + body.attr('validation_id'),
                  success: function(data, status, xhr) {
                    if (data.result === 'false') {
                      hideContent();
                    } else {
                      showContent();
                    }
                   },
                  error: function(xhr,status,err) {
                    alert("error" + status);
                  },
                  accepts: 'json'}
                  );
      } else {
        showContent();
      }
      } else {
      showContent();
      }
  } else {
    showContent();
  }

  function showContent() {
      $('#main-content').attr('style', 'visibility:visible');
  }
  function hideContent() {
      alert('hide');
      window.location.replace('<%= facilities_management_new_user_session_path %>');
  }

</script>
