<%= add_optional_error_prefix_to_page_title(@journey.errors) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    <%= render partial: 'shared/error_summary', locals: { errors: @journey.errors } %>

    <div id="ccs-error-sum" class="govuk-error-summary govuk-visually-hidden ccs-e-msg" aria-labelledby="error-summary-title" role="alert" data-module="error-summary">
      <h2 class="govuk-error-summary__title" id="error-summary-title"><%= t('common.error_summary_title') %></h2>
      <div class="govuk-error-summary__body">
        <ul id="ccs-error-sum-list" class="govuk-list govuk-error-summary__list">
          <li>
            <a href="#lot_Property_and_construction">
              <%= t('activemodel.errors.models.legal_services/journey/lot1_regional_service.attributes.lot1_regional_service.too_short') %>
            </a>
          </li>
        </ul>
      </div>
    </div>

    <%= form_tag @form_path, class: 'ccs-form', id: 'lot1_regional_service', method: :get do %>
      <%= hidden_fields_for_previous_steps_and_responses(@journey) %>

          <div class="govuk-grid-row">
            <div class="govuk-grid-column-full">

              <h1 class="govuk-caption-m govuk-!-margin-bottom-1">
                <%= t('.heading') %>
              </h1>

            </div>
          </div>

        <%= govuk_form_group_with_optional_error(@journey, :lot1_region) do %>

          <div id="ccs-dynamic-accordian" class="govuk-grid-row">
            <section id="accordion-default" class="govuk-grid-column-two-thirds">

                <%= govuk_fieldset_with_optional_error(@journey, :lot1_region) do %>

                <legend class="govuk-fieldset__legend govuk-fieldset__legend--m govuk-!-margin-bottom-1">
                  <%= t('.hint') %>
                </legend>

                <%= display_error(@journey, :lot1_region) %>

                <span id="legal_services-error" class="govuk-error-message govuk-visually-hidden ccs-e-msg">
                  <%= t('activemodel.errors.models.legal_services/journey/lot1_regional_service.attributes.lot1_regional_service.too_short') %>
                </span>

                <div class="govuk-checkboxes ccs-govuk-checkboxes--thin">
                  <%sqlHash = {} %>
                  <% params[:lot1].each do | arg | %>
                    <% arg_no_slash = arg.gsub('/', '_') %>
                    <% arg_no_space = arg_no_slash.gsub(' ', '_') %>
                    <% arg = arg_no_space.downcase %>
                    <% sqlStr = "{:#{arg}=>'x'}" %>
                    <% sqlHash1 = eval(sqlStr) %>
                    <% sqlHash = sqlHash.merge(sqlHash1) %>
                  <%end %>
                  <% sqlStr ="{:region=>#{params[:region1]}}" %>
                  <% sqlHash1 = eval(sqlStr) %>
                  <% sqlHash = sqlHash.merge(sqlHash1) %>
                  <% lot1 =  LegalServices::Region.where(sqlHash) %>
                  <% sqlHash1 = eval(sqlStr) %>
                  <% sqlHash = sqlHash.merge(sqlHash1) %>
                  <% lot1.each do |lot| %>
                    <div class="govuk-checkboxes__item">
                      <% lot_no_slash = lot.firm.gsub('/', '_') %>
                      <% lot_no_space = lot_no_slash.gsub(' ', '_') %>
                      <%= check_box_tag(
                                  "lot1_firm",
                                  lot.firm,
                                  false,
                                  class: "govuk-checkboxes__input",
                                  id: "lot_#{lot_no_space}"
                                ) %>
                      <label class="govuk-label govuk-checkboxes__label" for="lot_<%= lot_no_space %>">
                        <%= lot.firm %>
                      </label>
                    </div>
                  <% end %>
                </div>

                <p id="hint" class="govuk-body govuk-!-margin-top-7 govuk-!-margin-bottom-0">
                  <%= t('.links_text_html') %>
                </p>

              <%= submit_tag t('common.submit'), id: 'submit01', class: "govuk-button govuk-!-margin-top-6 govuk-!-margin-bottom-8 govuk-!-padding-left-7 govuk-!-padding-right-7" %>
            </section>

            <section class="govuk-grid-column-one-third">
              <div id="css-list-basket">
                <%= submit_tag t('common.submit'), id: 'submit02', class: "govuk-button" %>

                <div>
                  <h3 class="govuk-heading-m" data-txt01="<%= t('.txt01') %>" data-txt02="<%= t('.txt02') %>"><span></span> <span></span></h3>
                  <a role="button" href="#" class="ccs-remove govuk-link--no-visited-state ccs-no-print" id="removeAll"><%= t('.remove_all') %></a>
                  <ul class="govuk-list"></ul>
                </div>
              </div>
            </section>

          </div>

        <% end %>
      <% end %>

    <% end %>

  </div>
</div>
