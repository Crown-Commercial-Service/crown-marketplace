<%= add_optional_error_prefix_to_page_title(@journey.errors) %>
<%= render partial: 'shared/error_summary', locals: { errors: @journey.errors } %>

  <div id="ccs-error-sum" class="govuk-error-summary govuk-visually-hidden ccs-e-msg" aria-labelledby="error-summary-title" role="alert" data-module="error-summary">
    <h2 class="govuk-error-summary__title" id="error-summary-title"><%= t('common.error_summary_title') %></h2>
    <div class="govuk-error-summary__body">
      <ul id="ccs-error-sum-list" class="govuk-list govuk-error-summary__list">
        <li>
          <a href="#central_government_yes">
            <%= t('activemodel.errors.models.legal_services/journey/lot1_regional_service.attributes.lot_region.too_short') %>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <%= form_tag @form_path, class: :'ccs-form', method: :get do %>
  <%= hidden_fields_for_previous_steps_and_responses(@journey) %>

  <%= govuk_form_group_with_optional_error(@journey, :lot_region) do %>
    <%= govuk_fieldset_with_optional_error(@journey, :lot_region) do %>

      <div id="ccs-dynamic-accordian" class="govuk-grid-row">

        <section id="accordion-default" class="govuk-grid-column-two-thirds">

          <legend class="govuk-fieldset__legend govuk-fieldset__legend--s govuk-!-margin-0">
            <h1 class="govuk-!-margin-top-0 govuk-!-margin-bottom-6">
              <%= t('.heading') %>
            </h1>
          </legend>

          <%= display_error(@journey, :lot_region) %>

          <span id="legal_services-error" class="govuk-error-message govuk-visually-hidden ccs-e-msg">
            <%= t('activemodel.errors.models.legal_services/journey/lot1_regional_service.attributes.lot_region.too_short') %>
          </span>

          <div class="govuk-checkboxes ccs-govuk-checkboxes--thin">

            <% lot1 = ['North East', 'North West','Yorkshire and the Humber','East Midlands', 'West Midlands','East of England', 'Greater London', 'South East','South West','Wales','Scotland','Northern Ireland','Full national coverage'] %>

            <% lot1.each do |lot| %>
              <div class="govuk-checkboxes__item">
                <%= check_box_tag(
                            "regional_legal_service",
                            lot,
                            false,
                            class: "govuk-checkboxes__input",
                            id: "lot_#{lot}"
                          ) %>
                <label class="govuk-label govuk-checkboxes__label" for="lot_<%= lot %>">
                  <%= lot %>
                </label>
              </div>

            <% end %>

            <p class="govuk-body govuk-!-margin-top-4">Or</p>

          </div>

          <%= submit_tag t('common.submit'), id: "submit01", class: "govuk-button govuk-!-margin-top-6 govuk-!-padding-left-7 govuk-!-padding-right-7" %>

        </section>

        <section class="govuk-grid-column-one-third">
          <div id="css-list-basket">
            <%= submit_tag t('common.submit'), id: "submit02", class: "govuk-button" %>

            <div>
              <h3 class="govuk-heading-m" data-txt01="<%= t('.txt01') %>" data-txt02="<%= t('.txt02') %>"><span></span> <span></span></h3>
              <a role="button" href="#" class="ccs-remove govuk-link--no-visited-state ccs-no-print" id="removeAll"><%= t('.remove_all') %></a>
              <ul class="govuk-list"></ul>
            </div>
          </div>
        </section>

      </div>

    <% end %>
  <% end %>

<% end %>

<script>
  function initFormVal(){

    $('#submit01').add('#submit02').click(function(e){
      var form = $('#main-content').find('form');
      var state = form.find('input[name="regional_legal_service"]');

      if(state.prop("checked") == true){

        form.submit();

      }else{
        e.preventDefault();

        var title = $('html').children('head').find('title');
        title.text('Error: '+ title.text().replace(/Error: /g,''));

        state.parents('.govuk-form-group').addClass('govuk-form-group--error');

        $('#ccs-error-sum').attr('tabindex','-1').focus().add('#legal_services-error').removeClass('govuk-visually-hidden');
      }
    });

  }

  function isValidatorLoaded(){
    if(window.jQuery){ initFormVal(); }
    else{ window.setTimeout('isValidatorLoaded();',100); }
  }
  isValidatorLoaded();
</script>

