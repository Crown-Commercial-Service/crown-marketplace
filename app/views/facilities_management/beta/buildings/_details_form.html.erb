<div class="govuk-!-width-two-thirds" data-module="character-count" data-maxlength="25">
  <%= govuk_form_field(@page_data[:model_object], :building_name, f.object_name, t('.building_name_label_html'), "", {}) do |gf| %>
    <%= f.text_field :building_name, class: "govuk-input govuk-input--width-20 js-character-count", required: true, maxlength: 25 %>
  <% end %>
</div>
<div class="govuk-!-width-two-thirds" data-module="character-count" data-maxlength="50">
  <%= govuk_form_field(@page_data[:model_object], :description, f.object_name, t('.description_label_html'), "", {}) do |gf| %>
    <%= f.text_field :description, class: "govuk-input govuk-input--width-20 js-character-count", maxlength: 50 %>
  <% end %>
</div>
<div class="govuk-!-width-two-thirds" data-module="find-address" data-element_prefix="postcode">
  <%= govuk_form_field(@page_data[:model_object], :address_postcode, f.object_name, t('.address_label_html'), "", {}) do |gf| %>
    <div data-module-part="postcode-source-container" class="<%= ' govuk-visually-hidden' if @page_data[:model_object].address_line_1.present? %>">
      <%= f.label :address_postcode, "Postcode", for: 'postcode_entry', class: "govuk-heading-s govuk-!-margin-top-3 govuk-!-margin-bottom-0" %>
      <%= text_field_tag :postcode_entry, @page_data[:model_object].address_postcode, class: "govuk-input govuk-input--width-10", id: "postcode_entry", "data-module-element": "postcode-source-input", maxlength: 9 %>
      <% if Rails.env.development? || Rails.env.test? %>
        <details class="govuk-details" style="z-index: 1; margin-left:1ex; margin-top:1ex; display:inline-block; position:absolute; font-size:smaller; width:50%;" data-module="govuk-details">
          <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            Postcode lookup helpers (visible in dev &amp; test)
          </span>
          </summary>
          <div class="govuk-details__text" onclick="this.parentElement.getElementsByTagName('summary').item(0).click()" style="background-color: lemonchiffon;">
            <p class="govuk-heading-s">Bad postcodes:</p>
            <blockquote>
              <% ['X12 1XX'].each do |pcode| %>
                <span style="cursor: default;" onmouseout="this.style.textDecoration='none'" onmouseover="this.style.textDecoration='underline'" data-module-helper=postcode><%= pcode %></span>
              <% end %>
            </blockquote>
            <p class="govuk-heading-s">Postcode with new developments (non-existant addresses?):</p>
            <blockquote>
              <%
                ['NN8 1RF', 'NN8 1LF', 'WV1 4JX'].each do |pcode| %>
                <span style="cursor: default;" onmouseout="this.style.textDecoration='none'" onmouseover="this.style.textDecoration='underline'" data-module-helper=postcode><%= pcode %></span>
              <% end %>
            </blockquote>
            <p class="govuk-heading-s">Multiple regions:</p>
            <blockquote>
              <% ['N12 9RF'].each do |pcode| %>
                <span style="cursor: default;" onmouseout="this.style.textDecoration='none'" onmouseover="this.style.textDecoration='underline'" data-module-helper=postcode><%= pcode %></span>
              <% end %>
            </blockquote>
            <p class="govuk-heading-s">No regions:</p>
            <blockquote>
              <% ['NN8 1LF'].each do |pcode| %>
                <span style="cursor: default;" onmouseout="this.style.textDecoration='none'" onmouseover="this.style.textDecoration='underline'" data-module-helper=postcode><%= pcode %></span>
              <% end %>
            </blockquote>
            <p class="govuk-heading-s">Complex results:</p>
            <blockquote>
              <%
                ['L3 9PP', 'L7 6HD', 'SA38 9BH', 'SP11 9AY', 'NN1 5BT', 'NN8 1LS', 'N12 9RF', 'AB11 5PN', 'AB11 5PL', 'AB12 4SB', 'AB12 3LF', 'AB10 6PP', 'AB10 1QS', 'NE6 1LA', 'SW1X 9AE', 'MK41 0RU', 'NN8 4PW'].each do |pcode| %>
                <span style="cursor: default;" onmouseout="this.style.textDecoration='none'" onmouseover="this.style.textDecoration='underline'" data-module-helper=postcode><%= pcode %></span>
              <% end %>
            </blockquote>
          </div>
        </details>
      <% end %>
      <%= f.hidden_field :address_postcode, id: "address-postcode" %>
      <%= f.hidden_field :address_line_1, id: 'address-line-1' %>
      <%= f.hidden_field :address_line_2, id: 'address-line-2' %>
      <%= f.hidden_field :address_town, id: 'address-town' %>
      <%= f.hidden_field :address_region, id: 'address-region' %>
      <%= f.hidden_field :address_region_code, id: 'address-region-code' %>
      <br/>
      <button type="button" class="govuk-button govuk-!-margin-top-3" style="clear:both" data-module-element="trigger"><%= t('.find_address') %></button>
    </div>
  <% end %>
  <div class="govuk-!-margin-bottom-3 govuk-!-margin-top-0" data-module-part="lookup-container">
    <div data-module-part="lookup-results" data-module-action="<%= 'fetch' if @page_data[:model_object].address_line_1.blank? %>" class="govuk-!-margin-bottom-3 govuk-visually-hidden">
      <span id="postcode-header" class="govuk-heading-s govuk-!-margin-bottom-1" style="margin-top:-1.7ex"><%= t('.postcode') %></span>
      <span class="govuk-body govuk-!-margin-right-4" data-module-element="postcode-entry-text"></span>
      <a href="#postcode_header" class="govuk-link" data-module-element="change-input"><%= t('.change') %></a>
      <label for="results-container" class="govuk-heading-s govuk-!-margin-top-3 govuk-!-margin-bottom-1"><%= t('.select_an_address') %></label>
      <select class="govuk-select govuk-!-margin-top-2 govuk-!-width-two-thirds" data-module-element="results-container" data-nodata-text="<%= t('.zero_address_found') %>" data-withdata-text-single="<%= t('.option_with_data_single') %>" data-withdata-text-plural="<%= t('.option_with_data_plural') %>" id="results-container">
        <optgroup label="<%= t('.zero_address_found') %>"></optgroup>
      </select>
      <%= f.submit(t('.cant_find_address'), class: 'govuk-link govuk-!-margin-right-4 button_as_link',
                   data: { disable_with: false }, name: 'add_address') %>
    </div>
    <div class="govuk-!-margin-top-3 govuk-!-margin-bottom-3 <%= ' govuk-visually-hidden' unless @page_data[:model_object].address_line_1.present? %>" data-module-part="address-display">&nbsp;
      <span class="govuk-heading-s govuk-!-margin-bottom-1" style="margin-top:-1.7ex"><%= t('.address') %></span>
      <div class="govuk-body govuk-!-margin-bottom-2" data-module-part="address_text">
        <% unless @page_data[:model_object].address_line_1.blank? %>
          <%= address_in_a_line @page_data[:model_object] %>
        <% end %>
      </div>
      <a href="#postcode-header" class="govuk-link" data-module-element="change-input"><%= t('.change') %></a>
    </div>
    <div data-module-part="region-display">
      <div class="govuk-!-margin-bottom-3">
        <br/>
        <span id="region-header" class="govuk-heading-s govuk-!-margin-bottom-1" style="margin-top:-1.7ex"><%= t('.region') %></span>
        <span class="govuk-caption-m"><%= t('.region_desc') %></span>
      </div>
      <div data-module-part="lookup-region-results" data-module-action="<%= 'fetch' if @page_data[:model_object].address_region_code.blank? %>" class="<%= 'govuk-visually-hidden' unless region_needs_resolution? %>">
        <label for="region-results-container" class="govuk-heading-s govuk-!-margin-top-3 govuk-!-margin-bottom-1"><%= t('.select_a_region') %></label>
        <select class="govuk-select govuk-!-margin-top-2 govuk-!-width-two-thirds" data-module-element="region-results-container" data-nodata-text="<%= t('.zero_regions_found') %>" data-withdata-text-single="<%= t('.region_option_with_data_single') %>" data-withdata-text-plural="<%= t('.region_option_with_data_plural') %>" id="region-results-container">
          <optgroup label="<%= multiple_regions? ? t('.region_option_with_data_plural').sub('{%}', valid_regions.length.to_s) : t('.region_option_with_data_single') %>"></optgroup>
          <% if valid_regions.length > 0 then %>
            <option value="">Please select a region</option>
          <% end %>
          <% valid_regions.each do |region| %>
            <option value="<%= region['code'] %>" <%= 'selected' if @page_data[:model_object].address_region_code == region['code'] %>
                    data-address_region="<%= region['region'] %>" data-address_region_code="<%= region['code'] %>"><%= region['region'] %></option>
          <% end %>
        </select>
      </div>
      <div data-module-part="region-results" class="govuk-!-margin-bottom-3<%= ' govuk-visually-hidden' unless !region_needs_resolution? || @page_data[:model_object].address_region_code.present? %>">
        <p class="govuk-!-margin-bottom-2" data-module-part="region-text"><%= @page_data[:model_object].address_region %></p>
        <a href="#region-header" class="govuk-link <%= 'govuk-visually-hidden' unless multiple_regions? %>" style="display:block;"
           data-module-element="change-region-button"><%= t('.change') %></a>
      </div>
    </div>
  </div>
</div>
